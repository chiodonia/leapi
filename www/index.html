<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name='viewport' content='width=device-width, initial-scale=1, user-scalable=no' />
	<title>Le api</title>
<style>

    body {
        width: 1024px;
        width: 768px;
        margin: 0px;
        background-color: rgb(252, 252, 223);
    }
    
    .loading-background {
        background-image: url("img/loading.png");
        background-size: 768px 1024px;
        background-repeat: no-repeat;
        background-color: rgb(252, 252, 223);
    }

    .full-screen {
        position: absolute;
        width: 768px;
        height: 1024px;
        z-index: 10;
    }
    
	#button1 {
        position:absolute;
        left:70px;
        top:170px;
        width: 104px;
        height: 90px;
	}

    #button2 {
        position:absolute;
        left:156px;
        top:120px;
        width: 104px;
        height: 90px;
	}

    #button3 {
        position:absolute;
        left:242px;
        top:70px;
        width: 104px;
        height: 90px;
	}

    #button4 {
        position:absolute;
        left:330px;
        top:20px;
        width: 104px;
        height: 90px;
	}

    #button5 {
        position:absolute;
        left:414px;
        top:70px;
        width: 104px;
        height: 90px;
	}

    #button6 {
        position:absolute;
        left:499px;
        top:120px;
        width: 104px;
        height: 90px;
	}

    #button7 {
        position:absolute;
        left:584px;
        top:170px;
        width: 104px;
        height: 90px;
	}

	#buttonhome {
        position:absolute;
        left:10px;
        top:10px;
        width: 60px;
        height: 60px;
	}

	#buttontutorial {
        position:absolute;
        left:698px;
        top:10px;
        width: 60px;
        height: 60px;
	}

	video {
        position: absolute;
        width: 768px;
        height: 1024px;
        background-size: cover;
        z-index: -10;
	}

</style>
</head>
<body>
    <div id="page">
        <div id="container">
            <img id='tutorial' src='img/tuto_0.png' class='full-screen'>
        </div>
        <div id="videos"></div>
    </div>
    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>   
    <script src="js/jquery.min.js"></script>
    <!--
    <script src="js/hammer.min.js"></script>
    <script src="js/jquery.hammer.js"></script>
    -->
	<script>

		$(function() {

            var step = 0;

            function hideVideos() {
                $('#videos').html("");
                $('body').removeClass("loading-background");
            }
            
            function displayVideo(v) {
                var options = "autoplay preload='true'";
                if (v==0) {
                    options = options + " loop ";
                } 
                var html = "<video id='video"+v+"'" + options + ">" +
                        "<source src='video/video_"+v+".mp4' type='video/mp4'>" +
                        "Your browser does not support the video tag." +
                        "</video>";
                $('#videos').html(html);

                if (v>0) {
                    $('#video'+v).bind("ended", function() {
                        $('#video'+v).bind('click', function(event) {
//                        $('#video'+v).hammer().bind('tap', function(event) {
                            start(true);
                        });
                    });                    
                }
            }

            function tutorial() {
                if ($('#tutorial').length) {
                    $('#tutorial').attr('src', 'img/tuto_'+step+'.png');
                } else {
                    $('#container').html("<img id='tutorial' src='img/tuto_"+step+".png' class='full-screen'>");
                }
                
//                $('#tutorial').hammer().unbind('tap');
//                $('#tutorial').hammer().bind('tap', function(event) {
                $('#tutorial').unbind('click');
                $('#tutorial').bind('click', function(event) {
                      if (step<6) {
                          step = step + 1;
                          tutorial();
                      } else {
                          start(false);
                      }
                });
                if (step==6) {
                      displayVideo(0);
                } 
            }

		 	function disableButtonsExcept(b) {
				for (var i = 1; i <= 7; i++) {
                    if (i!=b) {
                        $('#button'+i).attr('src', 'img/bu_'+i+'_off.png');
                    } 
                    $('#button'+i).unbind('click');
				}
		 	}

            function enableButtons() {
                var html = "<img id='buttonhome' src='img/bu_home.png'><img id='buttontutorial' src='img/bu_tutorial.png'>";
                for (var b = 1; b <= 7; b++) {
                    html = html + "<img id='button" + b + "' src='img/bu_" + b + "_on.png'>";
                }
                $('#container').html(html);
                $('#buttonhome').bind("click", function() {
                      home();
                });
                $('#buttontutorial').bind("click", function() {
                      startTutorial();
                });
                for (var b = 1; b <= 7; b++) {
                    (function(index) {
                            $('#button'+index).bind('click', function(event) {
                                startVideo(index);
                            });
                     })(b);                    
                }
		 	}

            function startTutorial() {
//                $('#page').fadeOut('fast', function() {
                    step = 1;
                    hideVideos();
                    tutorial();
//                });
//                $('#page').fadeIn('fast');                                
            }

            function home() {
//                $('#page').fadeOut('fast', function() {
                    step = 0;
                    hideVideos();
                    tutorial();
//                });
//                $('#page').fadeIn('fast');                                
            }
            
            function startVideo(v) {
//                $('#page').fadeOut('fast', function() {
                    disableButtonsExcept(v);
                    displayVideo(v);
//                });
//                $('#page').fadeIn('fast');                                
            }
            
		 	function start(video0) {
//                $('#page').fadeOut('fast', function() {
                    $('body').addClass("loading-background");
                    enableButtons();
                    if (video0) {
                        displayVideo(0);
                    }
//                });
//                $('#page').fadeIn('fast');                                
		 	}

            home();

		});

	</script>
</body>
</html>
